# Key Objects

[_Documentation generated by Documatic_](https://www.documatic.com)

<!---Documatic-section-dhash.format_bytes-start--->
## dhash.format_bytes

<!---Documatic-section-format_bytes-start--->
### Summary

Format a row and column hash into bytes.

<!---Documatic-block-dhash.format_bytes-start--->
<details>
	<summary><code>dhash.format_bytes</code> code snippet</summary>

```python
def format_bytes(row_hash, col_hash, size=8):
    bits_per_hash = size * size
    full_hash = row_hash << bits_per_hash | col_hash
    if IS_PY3:
        return full_hash.to_bytes(bits_per_hash // 4, 'big')
    else:
        return '{0:0{1}x}'.format(full_hash, bits_per_hash // 2).decode('hex')
```
</details>
<!---Documatic-block-dhash.format_bytes-end--->
<!---Documatic-section-format_bytes-end--->

# #
<!---Documatic-section-dhash.format_bytes-end--->

<!---Documatic-section-dhash.get_grays-start--->
## dhash.get_grays

<!---Documatic-section-get_grays-start--->
### Summary

Get grayscale images.

<!---Documatic-block-dhash.get_grays-start--->
<details>
	<summary><code>dhash.get_grays</code> code snippet</summary>

```python
def get_grays(image, width, height):
    if isinstance(image, (tuple, list)):
        if len(image) != width * height:
            raise ValueError('image sequence length ({}) not equal to width*height ({})'.format(len(image), width * height))
        return image
    if wand is None and PIL is None:
        raise ImportError('must have wand or Pillow/PIL installed to use dhash on images')
    if wand is not None and isinstance(image, wand.image.Image):
        with image.clone() as small_image:
            small_image.type = 'grayscale'
            small_image.resize(width, height)
            blob = small_image.make_blob(format='RGB')
            if IS_PY3:
                return list(blob[::3])
            else:
                return [ord(c) for c in blob[::3]]
    elif PIL is not None and isinstance(image, PIL.Image.Image):
        gray_image = image.convert('L')
        small_image = gray_image.resize((width, height), PIL.Image.ANTIALIAS)
        return list(small_image.getdata())
    else:
        raise ValueError('image must be a wand.image.Image or PIL.Image instance')
```
</details>
<!---Documatic-block-dhash.get_grays-end--->
<!---Documatic-section-get_grays-end--->

# #
<!---Documatic-section-dhash.get_grays-end--->

<!---Documatic-section-dhash.format_hex-start--->
## dhash.format_hex

<!---Documatic-section-format_hex-start--->
### Summary

Format a row and column hash in hexadecimal.

<!---Documatic-block-dhash.format_hex-start--->
<details>
	<summary><code>dhash.format_hex</code> code snippet</summary>

```python
def format_hex(row_hash, col_hash, size=8):
    hex_length = size * size // 4
    return '{0:0{2}x}{1:0{2}x}'.format(row_hash, col_hash, hex_length)
```
</details>
<!---Documatic-block-dhash.format_hex-end--->
<!---Documatic-section-format_hex-end--->

# #
<!---Documatic-section-dhash.format_hex-end--->

<!---Documatic-section-dhash.dhash_row_col-start--->
## dhash.dhash_row_col

<!---Documatic-section-dhash_row_col-start--->
```mermaid
flowchart LR
dhash.dhash_row_col-->dhash.get_grays
```

### Summary

D - Hash row and column of an image.

### Object Calls

* dhash.get_grays

<!---Documatic-block-dhash.dhash_row_col-start--->
<details>
	<summary><code>dhash.dhash_row_col</code> code snippet</summary>

```python
def dhash_row_col(image, size=8):
    width = size + 1
    grays = get_grays(image, width, width)
    row_hash = 0
    col_hash = 0
    for y in range(size):
        for x in range(size):
            offset = y * width + x
            row_bit = grays[offset] < grays[offset + 1]
            row_hash = row_hash << 1 | row_bit
            col_bit = grays[offset] < grays[offset + width]
            col_hash = col_hash << 1 | col_bit
    return (row_hash, col_hash)
```
</details>
<!---Documatic-block-dhash.dhash_row_col-end--->
<!---Documatic-section-dhash_row_col-end--->

# #
<!---Documatic-section-dhash.dhash_row_col-end--->

<!---Documatic-section-dhash.format_grays-start--->
## dhash.format_grays

<!---Documatic-section-format_grays-start--->
### Summary

Format a list of gray - codes.

<!---Documatic-block-dhash.format_grays-start--->
<details>
	<summary><code>dhash.format_grays</code> code snippet</summary>

```python
def format_grays(grays, size=8):
    width = size + 1
    lines = []
    for y in range(width):
        line = []
        for x in range(width):
            gray = grays[y * width + x]
            line.append(format(gray, '4'))
        lines.append(''.join(line))
    return '\n'.join(lines)
```
</details>
<!---Documatic-block-dhash.format_grays-end--->
<!---Documatic-section-format_grays-end--->

# #
<!---Documatic-section-dhash.format_grays-end--->

<!---Documatic-section-dhash.dhash_int-start--->
## dhash.dhash_int

<!---Documatic-section-dhash_int-start--->
```mermaid
flowchart LR
dhash.dhash_int-->dhash.dhash_row_col
dhash.dhash_row_col-->dhash.get_grays
```

### Summary

Calculate a D - hash for an image.

### Object Calls

* dhash.dhash_row_col

<!---Documatic-block-dhash.dhash_int-start--->
<details>
	<summary><code>dhash.dhash_int</code> code snippet</summary>

```python
def dhash_int(image, size=8):
    (row_hash, col_hash) = dhash_row_col(image, size=size)
    return row_hash << size * size | col_hash
```
</details>
<!---Documatic-block-dhash.dhash_int-end--->
<!---Documatic-section-dhash_int-end--->

# #
<!---Documatic-section-dhash.dhash_int-end--->

<!---Documatic-section-dhash.get_num_bits_different-start--->
## dhash.get_num_bits_different

<!---Documatic-section-get_num_bits_different-start--->
### Summary

Returns the number of bits different between two hashes.

<!---Documatic-block-dhash.get_num_bits_different-start--->
<details>
	<summary><code>dhash.get_num_bits_different</code> code snippet</summary>

```python
def get_num_bits_different(hash1, hash2):
    return bin(hash1 ^ hash2).count('1')
```
</details>
<!---Documatic-block-dhash.get_num_bits_different-end--->
<!---Documatic-section-get_num_bits_different-end--->

# #
<!---Documatic-section-dhash.get_num_bits_different-end--->

<!---Documatic-section-dhash.force_pil-start--->
## dhash.force_pil

<!---Documatic-section-force_pil-start--->
### Summary

Force the PIL library to be installed.

<!---Documatic-block-dhash.force_pil-start--->
<details>
	<summary><code>dhash.force_pil</code> code snippet</summary>

```python
def force_pil():
    global wand
    if PIL is None:
        raise ValueError('Pillow/PIL library must be installed to use force_pil()')
    wand = None
```
</details>
<!---Documatic-block-dhash.force_pil-end--->
<!---Documatic-section-force_pil-end--->

# #
<!---Documatic-section-dhash.force_pil-end--->

<!---Documatic-section-dhash.format_matrix-start--->
## dhash.format_matrix

<!---Documatic-section-format_matrix-start--->
### Summary

Format a matrix of hash_int.

<!---Documatic-block-dhash.format_matrix-start--->
<details>
	<summary><code>dhash.format_matrix</code> code snippet</summary>

```python
def format_matrix(hash_int, bits='01', size=8):
    output = '{:0{}b}'.format(hash_int, size * size)
    if IS_PY3:
        output = output.translate({ord('0'): bits[0], ord('1'): bits[1]})
    else:
        output = unicode(output).translate({ord('0'): unicode(bits[0]), ord('1'): unicode(bits[1])})
        output = type(bits[0])(output)
    width = size * len(bits[0])
    lines = [output[i:i + width] for i in range(0, size * width, width)]
    return '\n'.join(lines)
```
</details>
<!---Documatic-block-dhash.format_matrix-end--->
<!---Documatic-section-format_matrix-end--->

# #
<!---Documatic-section-dhash.format_matrix-end--->

[_Documentation generated by Documatic_](https://www.documatic.com)